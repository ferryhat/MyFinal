{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/FERIEL/Desktop/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/FERIEL/Desktop/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/FERIEL/Desktop/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useContext}from'react';import{NavLink,useHistory}from\"react-router-dom\";import Stripe from\"react-stripe-checkout\";import{UserContext}from\"../App\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Mycart=function Mycart(){var _useContext=useContext(UserContext),state=_useContext.state,dispatch=_useContext.dispatch;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),cartUser=_useState2[0],setCartUser=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),items=_useState4[0],setItems=_useState4[1];var itemsPrice;var getCartData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,data,error;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch('/getCartData',{method:'GET'});case 3:res=_context.sent;_context.next=6;return res.json();case 6:data=_context.sent;setCartUser(data.userById);setItems(data.cartItems);if(!(!res.status===200)){_context.next=12;break;}error=new Error(res.error);throw error;case 12:_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 17:case\"end\":return _context.stop();}},_callee,null,[[0,14]]);}));return function getCartData(){return _ref.apply(this,arguments);};}();useEffect(function(){getCartData();},[]);items.map(function(items){itemsPrice=items.price;});var handlePayMethod=function handlePayMethod(itemsPrice,token){return fetch(\"/stripePay\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({token:token.id,amount:itemsPrice})});};var tokenHandler=function tokenHandler(token){handlePayMethod(itemsPrice,token);updateDataBase();};var updateDataBase=function updateDataBase(){return fetch(\"/updateDataBase\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({items:items})});};var Loginbutton=function Loginbutton(){if(state){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(NavLink,{className:\"btn\",to:\"/signout\",children:\"logout\"})})});}else{return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(NavLink,{className:\"btn\",to:\"/signin\",children:\"login\"})})});}};var cartitemid;var deleteItem=function deleteItem(e){cartitemid=e.target.id;return fetch(\"/deleteitemfromcart\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({cartitemid:cartitemid})});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"header\",{className:\"header\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"menu-btn\",className:\"fas fa-bars\"}),/*#__PURE__*/_jsxs(NavLink,{className:\"logo\",to:\"/\",children:[\" \",/*#__PURE__*/_jsx(\"span\",{children:\"Krily\"}),\"Car \"]}),/*#__PURE__*/_jsxs(\"nav\",{className:\"navbar\",children:[/*#__PURE__*/_jsx(NavLink,{to:\"/\",children:\"Home\"}),/*#__PURE__*/_jsx(NavLink,{to:\"/rentcar\",children:\"Rent A Car\"})]}),/*#__PURE__*/_jsx(\"div\",{id:\"login-btn\",children:/*#__PURE__*/_jsx(Loginbutton,{})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"salecartMaindiv\",children:/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:\"150px\"},children:[items.map(function(items){return/*#__PURE__*/_jsx(\"div\",{className:\"salecartLidiv\",children:/*#__PURE__*/_jsx(\"ul\",{children:/*#__PURE__*/_jsxs(\"li\",{style:{wordSpacing:\"10px\"},children:[\"Brand: \",items.brand,\" --- Model: \",items.model,\" --- Quantity: \",items.quantity,\" --- Price: \",items.price,\"Taka \",/*#__PURE__*/_jsx(\"button\",{id:items._id,onClick:deleteItem,className:\"btn\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-trash\"})})]})})},items._id);}),/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"30px\",textAlign:\"center\"},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Pay Through Credit / Debit Cared\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Stripe,{stripeKey:\"pk_test_51Jyb5UBvc4Qazj8jy6qimLop4epxe5jziUD3ixj5ISycjjD6yYVGZhk688Pz9Lna32VTHbSHxRwkrvNNnnnr96P000M68u5jcd\",token:tokenHandler})]})]})})]});};export default Mycart;","map":{"version":3,"names":["React","useState","useEffect","useContext","NavLink","useHistory","Stripe","UserContext","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Mycart","_useContext","state","dispatch","_useState","_useState2","_slicedToArray","cartUser","setCartUser","_useState3","_useState4","items","setItems","itemsPrice","getCartData","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","data","error","wrap","_callee$","_context","prev","next","fetch","method","sent","json","userById","cartItems","status","Error","t0","console","log","stop","apply","arguments","map","price","handlePayMethod","token","headers","body","JSON","stringify","id","amount","tokenHandler","updateDataBase","Loginbutton","children","className","to","cartitemid","deleteItem","e","target","style","marginTop","wordSpacing","brand","model","quantity","_id","onClick","padding","textAlign","stripeKey"],"sources":["C:/Users/FERIEL/Desktop/client/src/components/Mycart.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react'\r\nimport { NavLink, useHistory } from \"react-router-dom\";\r\nimport Stripe from \"react-stripe-checkout\";\r\n\r\nimport { UserContext } from \"../App\"\r\n\r\nconst Mycart = () => {\r\n\r\n    const { state, dispatch } = useContext(UserContext)\r\n\r\n    const [cartUser, setCartUser] = useState([]);\r\n    const [items, setItems] = useState([]);\r\n    let itemsPrice;\r\n\r\n\r\n    const getCartData = async () => {\r\n        try {\r\n            const res = await fetch('/getCartData', {\r\n                method: 'GET',\r\n            });\r\n\r\n            const data = await res.json();\r\n            setCartUser(data.userById)\r\n            setItems(data.cartItems)\r\n\r\n\r\n            if (!res.status === 200) {\r\n                const error = new Error(res.error);\r\n                throw error;\r\n            }\r\n\r\n        } catch (error) {\r\n            console.log(error)\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        getCartData();\r\n    }, [])\r\n\r\n    items.map(items => {\r\n        itemsPrice = items.price;\r\n    })\r\n\r\n    const handlePayMethod = (itemsPrice, token) => {\r\n        return fetch(\"/stripePay\", {\r\n            method: \"POST\",\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({\r\n                token: token.id,\r\n                amount: itemsPrice\r\n            })\r\n        })\r\n\r\n    }\r\n\r\n    const tokenHandler = (token) => {\r\n        handlePayMethod(itemsPrice, token)\r\n        updateDataBase();\r\n    }\r\n\r\n    const updateDataBase = () => {\r\n        return fetch(\"/updateDataBase\", {\r\n            method: \"POST\",\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({\r\n                items\r\n            })\r\n        })\r\n    }\r\n\r\n\r\n\r\n\r\n    const Loginbutton = () => {\r\n\r\n        if (state) {\r\n            return <div>\r\n                <button ><NavLink className=\"btn\" to=\"/signout\">logout</NavLink></button>\r\n            </div>\r\n        }\r\n        else {\r\n            return <div>\r\n                <button ><NavLink className=\"btn\" to=\"/signin\">login</NavLink></button>\r\n\r\n            </div>\r\n        }\r\n    }\r\n\r\n    let cartitemid\r\n    const deleteItem = (e) => {\r\n        cartitemid = e.target.id;\r\n        return fetch(\"/deleteitemfromcart\", {\r\n            method: \"POST\",\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({\r\n                cartitemid\r\n            })\r\n        })\r\n    }\r\n\r\n\r\n    return (\r\n        <>\r\n            <header className=\"header\">\r\n                <div id=\"menu-btn\" className=\"fas fa-bars\"></div>\r\n                <NavLink className=\"logo\" to=\"/\"> <span>Krily</span>Car </NavLink>\r\n\r\n                <nav className=\"navbar\">\r\n                    <NavLink to=\"/\">Home</NavLink>\r\n                    <NavLink to=\"/rentcar\">Rent A Car</NavLink>\r\n                </nav>\r\n\r\n                <div id=\"login-btn\">\r\n                    <Loginbutton />\r\n                </div>\r\n            </header>\r\n\r\n            <div className='salecartMaindiv'>\r\n                <div style={{\r\n                    marginTop: \"150px\",\r\n\r\n                }}>\r\n                    {items.map((items) =>\r\n                        <div className=\"salecartLidiv\" key={items._id} >\r\n                            <ul>\r\n                                <li style={{ wordSpacing: \"10px\" }}>Brand: {items.brand} --- Model: {items.model} --- Quantity: {items.quantity} --- Price: {items.price}Taka <button id={items._id} onClick={deleteItem} className=\"btn\"><i className=\"fa fa-trash\"></i></button></li>\r\n                            </ul>\r\n                        </div>\r\n\r\n                    )}\r\n                    <div style={{ padding: \"30px\", textAlign: \"center\" }}>\r\n                        <h2>Pay Through Credit / Debit Cared</h2><br />\r\n                        <Stripe\r\n                            stripeKey=\"pk_test_51Jyb5UBvc4Qazj8jy6qimLop4epxe5jziUD3ixj5ISycjjD6yYVGZhk688Pz9Lna32VTHbSHxRwkrvNNnnnr96P000M68u5jcd\"\r\n                            token={tokenHandler}\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Mycart\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}